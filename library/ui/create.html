<!DOCTYPE html>
<html>

	<head>
		<meta charset = "utf-8">
        <meta name = "viewport" content = "width = device-width , intial-scale=1.0">
        <meta http-equiv = "X-UA-compatible" content = "ie=edge">
        <title> Create </title>
	</head>

<body>

<form   action="/saving" type="submit"  method="post"  onsubmit="return check()">

Oblect   : <input id ="example" type ="text" name ="username">
<button type="submit" onclick="myFunction()"  >UPLOAD</button>

<div id="selection">

<br>
Raw      :  <i id ="saved" ></i>
			<input id = "listNode" size = "55" placeholder="(xxx...,xxx...),(xxx...,xxx...)...." onkeypress="this.value = fixInputPattern(this.value)"/>
			<input id = "hidden_elements" min = "1" max = "100"></input><input id = "hidden_elements1" type="button" value="Enter a node size" onclick="add()"/><br>

			<button id = "dense" type="submit" onclick="denseFunction()"  >Dense</button>
			<button id = "sparse"type="submit" onclick="sparseFunction()"  >Sparse</button>

		   	<input id = "hiddenNodeSize" min = "1" max = "100" ></input>
			<input id = "hiddenButton" type="button" value="Enter a node size" onclick="add1()"/>

			<input id = "hiddensave" type="button" value="save" onclick="saving()"/>
			<form id="inputField"  onsubmit = "return false"></form><br>

Typeset  : <input type="text" id="Typeset" name="valueOfTypeset"/><i id ="warning3" ></i><br><br>
Features : Directed :
<select id="mySelect" size="1">
	<option></option>
    <option>True</option>
    <option>False</option>
</select>
<input id="resultField"  name = "jsonFile"/>
</div>



</form><br>


<script>
var myArray = [];
var file = {};

window.onload=function() {
  document.getElementById("selection").style.display="none";
  document.getElementById("resultField").style.display="none";
  document.getElementById("hidden_elements").style.display="none";
  document.getElementById("hidden_elements1").style.display="none";
  document.getElementById("hiddenNodeSize").style.display="none";
  document.getElementById("hiddenButton").style.display="none";
  document.getElementById("listNode").style.display="none";
  document.getElementById("hiddensave").style.display="none";
}


function saving() {
	document.getElementById("listNode").style.display="none";
    document.getElementById("hiddensave").style.display="none";
	var str = document.getElementById("listNode").value;
	document.getElementById("saved").innerHTML = "The values were  recorded";
	file.raw.sparse = str;

}
var denseNodeSize ;
function add() {
	document.getElementById("hidden_elements").style.display="none";
    document.getElementById("hidden_elements1").style.display="none";

    denseNodeSize = document.getElementById("hidden_elements").value ;
    var matrixSize = denseNodeSize * denseNodeSize;
    var rawNumber = -1;
    for (var i = 0; i < matrixSize; i++) {

    	if( (i % denseNodeSize) == 0){
        	rawNumber += 1;
        	var br = document.createElement("br");
            var element = document.getElementById("inputField");
            element.appendChild(br);
        }
        //Create an input type dynamically.
        var element = document.createElement("input");

        //Assign different attributes to the element.
        element.setAttribute("type", "number");
        element.setAttribute("value", "0");
        element.setAttribute("name","" + rawNumber);
        element.setAttribute("min", "0");
        element.setAttribute("max", "1");


        var foo = document.getElementById("inputField");

        //Append the element in page (in form).
        foo.appendChild(element);
   }

       //Create an input type dynamically.
        var elem = document.createElement("input");

        //Assign different attributes to the element.
        elem.setAttribute("type", "button");
        elem.setAttribute("value", "save");
        elem.setAttribute("onclick", "printScreen()");

        var fooo = document.getElementById("inputField");

        //Append the element in page (in form).
        fooo.appendChild(elem);


}


function printScreen() {
  	var controlBox = 1;
    var myArr = document.forms.inputField;
    var myControls = myArr;
    var name_value_array = [];
    var rawNumber = -1;
	var txt = "";
    var col  = document.getElementById("hidden_elements").value ;
    for (var i = 0; i < myControls.length; i++) {
    	if( (i % denseNodeSize) == 0){
        	rawNumber += 1;
        }
		var aControl = myControls[i];

		// don't print the button value
		if (aControl.type != "button") {
			// store value in a map
			if(aControl.value == 1)
			{

				var str = "(" + aControl.name + ","  + i%col + ")";
				txt += str + "";
				name_value_array.push(str);
			}

			if(aControl.value>1){
				controlBox = 0
			}
		}

    }
	document.getElementById("saved").innerHTML = "The values were  recorded";
	document.getElementById("inputField").style.display="none";
	file.raw.dense = txt;
}









function denseFunction() {
	document.getElementById("dense").style.display="none";
	document.getElementById("sparse").style.display="none";
	document.getElementById("hidden_elements").style.display="block";
	document.getElementById("hidden_elements1").style.display="block";
}
function sparseFunction() {
	document.getElementById("dense").style.display="none";
	document.getElementById("sparse").style.display="none";
	document.getElementById("hiddenButton").style.display="block";
	document.getElementById("hiddenNodeSize").style.display="block";

}


function add1() {

	document.getElementById("hiddenNodeSize").style.display="none";
    document.getElementById("hiddenButton").style.display="none";

    nodeSize = document.getElementById("hiddenNodeSize").value;
	nodeSizeLength = nodeSize.length;
    document.getElementById("listNode").style.display="block";
    document.getElementById("hiddensave").style.display="block";
}
var nodeSize;
var startNumber=1;
var lastCharacter = 0;// eğer son sayıdan önceki karakter , ise
var nodeSizeLength;

function fixInputPattern(currInp) {


    var currentInput = currInp;
    var currentLength = currentInput.length;
    var lastNumberEntered = currentInput[currentLength - 1];


    if (!isNumber(lastNumberEntered) && lastNumberEntered != "," && lastNumberEntered != ")" ) {
      	return currentInput.substring(0, currentLength-1);
    }

	if(currentInput[currentLength] == ")"){
		lastCharacter = 0;
    	startNumber = currentLength+1;
    	return currentInput.substring(0, currentLength) +"(";
    }

    if (currentLength == 0) {
    	lastCharacter = 0;
      	return currentInput.substring(0, currentLength) ;
    }

    if (currentLength == 1 ) {
    	startNumber=1;
      	return "(" + currentInput.substring(0, currentLength) ;
    }

    if (currentLength == 3  && nodeSize <=9 ) {
    	lastCharacter = 0;
      	return "(" + currentInput[1] + "," + currentInput[2] +")(";
    }

    if (lastNumberEntered == ")") {
    	startNumber = currentLength+1;
        lastCharacter = 0;
      	return currentInput.substring(0, currentLength) +"(";
    }



    if(currentInput.lastIndexOf(",") < currentInput.lastIndexOf("(") ){
    	lastCharacter = 0;
    	startNumber = currentInput.lastIndexOf("(")+1;
    }

    if(currentInput.lastIndexOf(",") > currentInput.lastIndexOf("(") ){
    	lastCharacter = 1;
    	startNumber = currentInput.lastIndexOf(",")+1;
    }

    if (lastNumberEntered == ",") {
    	startNumber = currentLength;
        lastCharacter = 1;
      	return currentInput.substring(0, currentLength);
    }


    if (currentLength > nodeSize*nodeSize ) {
      return currentInput.substring(0,nodeSize*nodeSize);
    }


    if(nodeSize <=9){


        if(lastNumberEntered > nodeSize ){
        	return currentInput.substring(0, currentLength-1)
        }


    	if(lastCharacter == 0 && lastNumberEntered <= nodeSize ){
        	lastCharacter = 1;
    		return currentInput.substring(0, currentLength) + ",";
        }


      	if(lastCharacter == 1 && lastNumberEntered <= nodeSize ){
        	lastCharacter = 0;
    		return currentInput.substring(0, currentLength) + ")(";
        }

    }

    var controlNumber = currentInput.substring(startNumber, currentLength);
  	if(Number(controlNumber) <= nodeSize && controlNumber.length == nodeSizeLength )
  	{
    	if(lastCharacter == 0){
        	lastCharacter = 1;
            startNumber = currentLength + 1;
    		return currentInput.substring(0, currentLength) + ",";
        }

    	if(lastCharacter == 1){
        	lastCharacter = 0;
            startNumber = currentLength + 2;
    		return currentInput.substring(0, currentLength) + ")(";
        }

    }

    if(Number(controlNumber) > nodeSize){
    	return currentInput.substring(0, startNumber);
    }


    return currentInput;
}



function isNumber(n) {
    return !isNaN(parseFloat(n)) && isFinite(n);
}



var x = 0; // global variable for control
function myFunction() {
	if(x == 0){
		if(document.getElementById("example").value == ""){  // If the button is pressed without inputting anything
			 document.getElementById("example").value = "graph"; // assigned a file to the box
		}


        file = {
          'name'       : 'graph',
          'plural'     : 'Graphs',
        }
		file['raw'] = {"dense" : " ",
					   "sparse":" ",}
		file['typeset'] = "";
		file['features'] = {'directed' : "",};

		document.getElementById("selection").style.display="block" // first of all div is hidden
																         // Paragraph becomes visible after the UPLOAD button is pressed
		x++; //
	}
	else{


		if(document.getElementById("Typeset").value == ""){
			document.getElementById("warning3").innerHTML = " Wrong input,you can write like this type1, type2, ....";

		}
		else{
			file.typeset = document.getElementById("Typeset").value;
			file.features.directed = document.getElementById("mySelect").value
			//myArray.push(file);
			//document.getElementById("warning3").innerHTML = "";
			document.getElementById("resultField").value = JSON.stringify(file);
		}

	}
}

function check() {


        if(document.getElementById("Typeset").value == ""){
            return false;
        }
        if(document.getElementById("mySelect").value == ""){
            return false;
        }
        if(document.getElementById("saved").value == ""){
            return false;
        }

        return true;

}
</script>

</body>
</html>